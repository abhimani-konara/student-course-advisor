<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Course Web Advisor - NIBM Final Project</title>

<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.main-container {
    max-width: 1200px;
    margin: 0 auto;
}

.container {
    background: white;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    margin-bottom: 20px;
}

.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 15px 15px 0 0;
    text-align: center;
    margin: -30px -30px 30px -30px;
}

.header h1 {
    font-size: 2.2rem;
    margin-bottom: 10px;
}

.header p {
    font-size: 1.1rem;
    opacity: 0.95;
}

h2 {
    text-align: center;
    color: #003399;
    margin-bottom: 25px;
    font-size: 1.8rem;
}

.hidden {
    display: none !important;
}

input, select, textarea {
    width: 100%;
    padding: 12px 15px;
    margin: 8px 0 15px 0;
    border-radius: 8px;
    border: 2px solid #e0e0e0;
    font-size: 1rem;
    transition: all 0.3s ease;
    font-family: inherit;
}

input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

label {
    display: block;
    font-weight: 600;
    color: #333;
    margin-top: 15px;
    margin-bottom: 5px;
}

button {
    width: 100%;
    padding: 14px;
    margin-top: 10px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    font-size: 1.1rem;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
}

button.secondary {
    background: #6c757d;
    margin-top: 15px;
}

button.secondary:hover {
    background: #5a6268;
}

.card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-top: 20px;
    border-left: 4px solid #667eea;
}

.student-card {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.student-card:hover {
    border-color: #667eea;
    transform: translateX(5px);
    background: #e7f3ff;
}

.student-card.selected {
    background: #e7f3ff;
    border-color: #667eea;
}

.results-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: 10px;
}

.results-grid select {
    margin: 0;
}

.link-text {
    text-align: center;
    margin-top: 20px;
}

.link-text a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
}

.link-text a:hover {
    text-decoration: underline;
}

hr {
    margin: 30px 0;
    border: none;
    border-top: 2px solid #e0e0e0;
}

/* Footer Styles */
footer {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px 30px;
    border-radius: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    margin-top: 30px;
}

.footer-content {
    max-width: 1200px;
    margin: 0 auto;
}

.footer-title {
    text-align: center;
    font-size: 1.8rem;
    margin-bottom: 30px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}

.footer-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
    margin-bottom: 30px;
}

.footer-section h4 {
    font-size: 1.2rem;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(255,255,255,0.3);
}

.footer-section p {
    margin: 10px 0;
    line-height: 1.6;
    opacity: 0.95;
}

.footer-divider {
    border-top: 1px solid rgba(255,255,255,0.3);
    padding-top: 25px;
    margin-top: 25px;
}

.tech-stack {
    line-height: 2;
    opacity: 0.95;
}

.copyright {
    text-align: center;
    padding-top: 20px;
    margin-top: 20px;
    border-top: 1px solid rgba(255,255,255,0.3);
    opacity: 0.9;
    font-size: 0.95rem;
}

/* Responsive Design */
@media (max-width: 768px) {
    .header h1 {
        font-size: 1.6rem;
    }
    
    .footer-grid {
        grid-template-columns: 1fr;
    }
    
    .results-grid {
        grid-template-columns: 1fr;
    }
}
</style>
</head>

<body>

<div class="main-container">

<div class="container">

<div class="header">
    <h1>üéì Student Course Web Advisor</h1>
    <p>AI-Powered Course Recommendation System</p>
</div>

<!-- ================= LOGIN PAGE ================= -->
<div id="loginPage">

<h2>Welcome Back!</h2>

<label>Select Role:</label>
<select id="loginRole">
    <option value="student">Student</option>
    <option value="advisor">Course Advisor</option>
</select>

<label>Username:</label>
<input type="text" id="loginUsername" placeholder="Enter your username">

<label>Password:</label>
<input type="password" id="loginPassword" placeholder="Enter your password">

<button onclick="login()">Login</button>

<div class="link-text">
    <p>Don't have an account? <a href="#" onclick="showSignup(); return false;">Sign up here</a></p>
</div>

<hr>

<h2>New Student Registration</h2>

<label>Choose Username:</label>
<input type="text" id="signupUsername" placeholder="Create a username">

<label>Choose Password:</label>
<input type="password" id="signupPassword" placeholder="Create a password">

<button onclick="signup()">Sign Up</button>

</div>

<!-- ================= STUDENT DASHBOARD ================= -->
<div id="studentDashboard" class="hidden">

<h2>üë®‚Äçüéì Student Dashboard</h2>

<label>A/L Stream:</label>
<select id="stream" onchange="autoFillSubjects()">
    <option value="">-- Select Your Stream --</option>
    <option value="Physical">Physical Science</option>
    <option value="Biological">Biological Science</option>
    <option value="Commerce">Commerce</option>
    <option value="Arts">Arts</option>
    <option value="Technology">Technology</option>
</select>

<label>Subject 1:</label>
<input type="text" id="sub1" placeholder="e.g., Physics">

<label>Subject 2:</label>
<input type="text" id="sub2" placeholder="e.g., Chemistry">

<label>Subject 3:</label>
<input type="text" id="sub3" placeholder="e.g., Combined Mathematics">

<label>A/L Results:</label>
<div class="results-grid">
    <select id="r1">
        <option value="A">A - Excellent</option>
        <option value="B">B - Very Good</option>
        <option value="C">C - Good</option>
        <option value="S">S - Satisfactory</option>
        <option value="W">W - Weak</option>
    </select>
    <select id="r2">
        <option value="A">A - Excellent</option>
        <option value="B">B - Very Good</option>
        <option value="C">C - Good</option>
        <option value="S">S - Satisfactory</option>
        <option value="W">W - Weak</option>
    </select>
    <select id="r3">
        <option value="A">A - Excellent</option>
        <option value="B">B - Very Good</option>
        <option value="C">C - Good</option>
        <option value="S">S - Satisfactory</option>
        <option value="W">W - Weak</option>
    </select>
</div>

<label>Current GPA (Optional - for 2nd year & above):</label>
<input type="number" id="gpa" placeholder="e.g., 3.2" step="0.01" min="0" max="4.0">

<label>Area of Interest:</label>
<select id="interest">
    <option value="">-- Select Your Interest --</option>
    <option value="Technology">Technology & Computing</option>
    <option value="Engineering">Engineering</option>
    <option value="Medical">Medical & Healthcare</option>
    <option value="Management">Business & Management</option>
    <option value="Teaching">Education & Teaching</option>
    <option value="Design">Design & Multimedia</option>
    <option value="Science">Science & Research</option>
    <option value="Data Science">Data Science & Analytics</option>
</select>

<button onclick="getRecommendation()">Get AI Recommendation</button>

<div id="studentOutput" class="card" style="display: none;">
    <p>Your recommendation will appear here...</p>
</div>

<button class="secondary" onclick="logout()">Logout</button>

</div>

<!-- ================= ADVISOR DASHBOARD ================= -->
<div id="advisorDashboard" class="hidden">

<h2>üë®‚Äçüè´ Course Advisor Dashboard</h2>

<div id="studentList"></div>

<label>Advisor Feedback:</label>
<textarea id="advisorFeedback" rows="5" placeholder="Write your feedback for the selected student..."></textarea>

<button onclick="saveFeedback()">Save Feedback</button>
<button class="secondary" onclick="logout()">Logout</button>

</div>

</div>

<!-- ================= PROFESSIONAL FOOTER ================= -->
<footer>
    <div class="footer-content">
        <h3 class="footer-title">üéì Student Course Advisor Web Application</h3>
        
        <div class="footer-grid">
            <div class="footer-section">
                <h4>üèõÔ∏è Academic Institution</h4>
                <p><strong>National Institute of Business Management (NIBM)</strong></p>
                <p>School of Computing and Engineering</p>
                <p>Diploma in Computer Science with Artificial Intelligence</p>
                <p>Program Code: DCSAI-25.1-F</p>
            </div>
            
            <div class="footer-section">
                <h4>üë• Development Team - Group 7</h4>
                <p><strong>Pasindu Bandara</strong> (KIC-DCSAI-251-F-030)</p>
                <p><strong>Abhimani Konara</strong> (KIC-DCSAI-251-F-028)</p>
                <p><strong>Chethani Thakshila</strong> (KIC-DCSAI-251-F-048)</p>
                <p><strong>Isurika Bandara</strong> (KIC-DCSAI-251-F-029)</p>
            </div>
            
            <div class="footer-section">
                <h4>üè¢ Partner Institution</h4>
                <p><strong>KIC - Kandy Innovation Centre</strong></p>
                <p>Final Year Project - 2026</p>
                <p>Project Type: AI-Powered Web Application</p>
                <p>Supervisor Approved</p>
            </div>
        </div>
        
        <div class="footer-divider">
            <h4 style="text-align: center; margin-bottom: 20px;">‚ö° Technology Stack</h4>
            <p class="tech-stack" style="text-align: center;">
                <strong>Frontend:</strong> HTML5, CSS3, JavaScript ES6<br>
                <strong>Backend:</strong> Node.js v24.12 + Express.js<br>
                <strong>AI Engine:</strong> SWI-Prolog v9.2.9 (Symbolic AI & Rule-Based Reasoning)<br>
                <strong>Database:</strong> SQLite 3<br>
                <strong>Development Tools:</strong> Visual Studio Code, Git & GitHub<br>
                <strong>Architecture:</strong> Full-Stack AI Integration with RESTful API
            </p>
        </div>
        
        <div class="copyright">
            <p>
                ¬© 2026 Student Course Advisor System | All Rights Reserved<br>
                Developed with üíú by Group 7 | NIBM & KIC Collaboration<br>
                <strong>Powered by Artificial Intelligence & Prolog Logic Engine</strong>
            </p>
        </div>
    </div>
</footer>

</div>

<script>
// ===================================================================
// Student Course Advisor - Frontend Application
// ===================================================================
// Developer: Abhimani Konara (KIC-DCSAI-251-F-028)
// Role: IDE Setup, Version Control, Full-Stack Integration
// Integration: Frontend ‚Üî Node.js Express ‚Üî SWI-Prolog ‚Üî SQLite
// Group 7 - NIBM Final Project - January 2026
// ===================================================================

const API_URL = 'http://localhost:3000/api';
let currentStudent = null;
let selectedStudent = null;

// ==================== NAVIGATION FUNCTIONS ====================

function showSignup() {
    // Scroll to signup section smoothly
    document.getElementById('signupUsername').scrollIntoView({ behavior: 'smooth' });
    document.getElementById('signupUsername').focus();
}

// ==================== AUTHENTICATION FUNCTIONS ====================

function signup() {
    const username = document.getElementById('signupUsername').value.trim();
    const password = document.getElementById('signupPassword').value;

    if (!username || !password) {
        alert("‚ö†Ô∏è Please fill in all fields");
        return;
    }

    if (password.length < 4) {
        alert("‚ö†Ô∏è Password must be at least 4 characters long");
        return;
    }

    fetch(`${API_URL}/signup`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: username, password: password })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert("‚úÖ Account created successfully! Please login with your credentials.");
            document.getElementById('signupUsername').value = '';
            document.getElementById('signupPassword').value = '';
            document.getElementById('loginUsername').value = username;
            document.getElementById('loginUsername').scrollIntoView({ behavior: 'smooth' });
        } else {
            alert("‚ùå " + (data.message || "Signup failed"));
        }
    })
    .catch(err => {
        console.error(err);
        alert("‚ùå Error during signup. Make sure the server is running!");
    });
}

function login() {
    const role = document.getElementById('loginRole').value;
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;

    if (!username || !password) {
        alert("‚ö†Ô∏è Please fill in all fields");
        return;
    }

    fetch(`${API_URL}/login`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: username, password: password, role: role })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            currentStudent = username;
            if (role === 'advisor') {
                showAdvisorDashboard();
            } else {
                showStudentDashboard();
            }
        } else {
            alert("‚ùå " + (data.message || "Invalid credentials"));
        }
    })
    .catch(err => {
        console.error(err);
        alert("‚ùå Error during login. Make sure the server is running!");
    });
}

function logout() {
    if (confirm("Are you sure you want to logout?")) {
        location.reload();
    }
}

// ==================== STUDENT FUNCTIONS ====================

function showStudentDashboard() {
    document.getElementById('loginPage').classList.add("hidden");
    document.getElementById('studentDashboard').classList.remove("hidden");
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function autoFillSubjects() {
    const stream = document.getElementById('stream').value;
    const subjectMap = {
        'Physical': ["Physics", "Chemistry", "Combined Mathematics"],
        'Biological': ["Biology", "Chemistry", "Physics"],
        'Commerce': ["Accounting", "Economics", "Business Studies"],
        'Arts': ["History", "Political Science", "Logic & Scientific Method"],
        'Technology': ["Engineering Technology", "ICT", "Science for Technology"]
    };

    if (subjectMap[stream]) {
        document.getElementById('sub1').value = subjectMap[stream][0];
        document.getElementById('sub2').value = subjectMap[stream][1];
        document.getElementById('sub3').value = subjectMap[stream][2];
    }
}

function getRecommendation() {
    const stream = document.getElementById('stream').value;
    const interest = document.getElementById('interest').value;
    const gpa = parseFloat(document.getElementById('gpa').value) || 0;

    if (!stream) {
        alert("‚ö†Ô∏è Please select your A/L stream");
        return;
    }

    if (!interest) {
        alert("‚ö†Ô∏è Please select your area of interest");
        return;
    }

    // Show loading state
    const outputDiv = document.getElementById('studentOutput');
    outputDiv.innerHTML = '<p style="text-align: center; padding: 20px;">‚è≥ Analyzing your profile with AI...</p>';
    outputDiv.style.display = 'block';

    // Gather all form data
    const requestData = {
        username: currentStudent,
        stream: stream,
        interest: interest,
        gpa: gpa,
        subjects: [
            document.getElementById('sub1').value,
            document.getElementById('sub2').value,
            document.getElementById('sub3').value
        ],
        results: [
            document.getElementById('r1').value,
            document.getElementById('r2').value,
            document.getElementById('r3').value
        ]
    };

    // Call backend API
    fetch(`${API_URL}/recommend`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(requestData)
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            outputDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; text-align: center;">
                    <h3 style="margin: 0 0 20px 0; font-size: 1.3rem; opacity: 0.95;">‚úÖ AI Recommendation Result</h3>
                    <h2 style="margin: 0; font-size: 2.2rem; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                        ${data.recommendation}
                    </h2>
                    <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.3);">
                        <p style="margin: 5px 0; opacity: 0.95;">üìö Stream: <strong>${stream}</strong></p>
                        <p style="margin: 5px 0; opacity: 0.95;">üí° Interest: <strong>${interest}</strong></p>
                        <p style="margin: 5px 0; opacity: 0.95;">üìä GPA: <strong>${gpa || 'N/A'}</strong></p>
                    </div>
                    <p style="margin-top: 20px; font-size: 0.95rem; opacity: 0.9;">
                        This recommendation is generated using AI-powered Prolog logic engine
                    </p>
                </div>
            `;
            outputDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } else {
            outputDiv.innerHTML = '<p style="color: #dc3545; text-align: center; padding: 20px;">‚ùå Unable to generate recommendation. Please try again.</p>';
        }
    })
    .catch(err => {
        console.error('Error:', err);
        outputDiv.innerHTML = `
            <p style="color: #dc3545; text-align: center; padding: 20px;">
                ‚ùå Error connecting to server.<br>
                Please make sure the backend server is running on port 3000!
            </p>
        `;
    });
}

// ==================== ADVISOR FUNCTIONS ====================

function showAdvisorDashboard() {
    document.getElementById('loginPage').classList.add("hidden");
    document.getElementById('advisorDashboard').classList.remove("hidden");
    window.scrollTo({ top: 0, behavior: 'smooth' });
    loadStudents();
}

function loadStudents() {
    fetch(`${API_URL}/students`)
    .then(res => res.json())
    .then(data => {
        const listDiv = document.getElementById('studentList');
        listDiv.innerHTML = "<h3 style='margin-bottom: 20px;'>üìã Registered Students</h3>";
        
        if (data.students && data.students.length > 0) {
            data.students.forEach(student => {
                const card = document.createElement("div");
                card.className = "student-card";
                card.innerHTML = `
                    <strong style="font-size: 1.1rem; color: #667eea;">üë§ ${student.username}</strong><br>
                    <span style="color: #666;">Stream:</span> ${student.stream || 'Not set'}<br>
                    <span style="color: #666;">Interest:</span> ${student.interest || 'Not set'}<br>
                    <span style="color: #666;">GPA:</span> ${student.gpa || 'N/A'}<br>
                    <span style="color: #666;">Recommendation:</span> <strong>${student.recommendation || 'Not generated'}</strong>
                `;
                card.onclick = () => selectStudentForFeedback(student.username, card);
                listDiv.appendChild(card);
            });
        } else {
            listDiv.innerHTML += '<p style="text-align: center; color: #666; padding: 20px;">No students have registered yet.</p>';
        }
    })
    .catch(err => {
        console.error(err);
        alert("‚ùå Error loading students");
    });
}

function selectStudentForFeedback(username, cardElement) {
    selectedStudent = username;
    
    // Remove selected class from all cards
    document.querySelectorAll('.student-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Add selected class to clicked card
    cardElement.classList.add('selected');
    
    // Load existing feedback
    fetch(`${API_URL}/feedback/${username}`)
    .then(res => res.json())
    .then(data => {
        document.getElementById('advisorFeedback').value = data.feedback || '';
        document.getElementById('advisorFeedback').focus();
    })
    .catch(err => {
        console.error(err);
        document.getElementById('advisorFeedback').value = '';
    });
}

function saveFeedback() {
    if (!selectedStudent) {
        alert("‚ö†Ô∏è Please select a student first");
        return;
    }
    
    const feedback = document.getElementById('advisorFeedback').value.trim();
    
    if (!feedback) {
        alert("‚ö†Ô∏è Please write some feedback");
        return;
    }
    
    fetch(`${API_URL}/feedback`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            student: selectedStudent,
            advisor: 'advisor',
            feedback: feedback
        })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert(`‚úÖ Feedback saved successfully for ${selectedStudent}!`);
        } else {
            alert("‚ùå Error saving feedback");
        }
    })
    .catch(err => {
        console.error(err);
        alert("‚ùå Error saving feedback");
    });
}

// ==================== INITIALIZATION ====================

// Focus on username field when page loads
window.addEventListener('DOMContentLoaded', function() {
    document.getElementById('loginUsername').focus();
});

</script>

</body>
</html>